{% extends 'base.html.twig' %}

{% block body %}
<body>
    <header class="hero">
        <h1>RÃ©servation pour le Concert de Jazz au Parc Lidia PoÃ«t</h1>
    </header>

    <section class="container">
        <div class="card">
            <h2>Concert de Jazz au Parc Lidia PoÃ«t</h2>
            <p><strong>Date :</strong> 5 avril 2025</p>
            <p><strong>Lieu :</strong> Parc Lidia PoÃ«t, Valmont</p>

            <form id="reservationForm" method="POST">
                <label for="nom">Nom :</label>
                <input type="text" id="nom" name="nom" required>

                <label for="email">Email :</label>
                <input type="email" id="email" name="email" required>

                <label for="nb_places">Nombre de places :</label>
                <input type="number" id="nb_places" name="nb_places" min="1" required>

                <button type="submit" class="btn btn-primary">Confirmer la rÃ©servation</button>
            </form>
        </div>
        <a href="{{ path('event') }}" class="btn btn-back">Retourner aux events</a>
    </section>

    <footer class="footer">
        <p>&copy; 2025 - Valmont | Ville connectÃ©e</p>
    </footer>

    <script src="{{ asset('search-panel.js') }}"></script>
<script>
document.getElementById('reservationForm').addEventListener('submit', function(event) {
    event.preventDefault();

    const formData = new FormData(this);

    fetch('{{ path('concert_jazz') }}', {
        method: 'POST',
        body: formData
    })
    .then(response => response.text().then(message => ({ ok: response.ok, message })))
    .then(({ ok, message }) => {
        if (ok) {
            alert(message); // "RÃ©servation enregistrÃ©e ! ðŸŽ·"
            document.getElementById('reservationForm').reset();
        } else {
            alert(message); // "DÃ©solÃ©, il n'y a plus assez de places disponibles. ðŸ˜¢"
        }
    })
    .catch(error => {
        console.error('Erreur:', error);
        alert('Erreur rÃ©seau.');
    });
});
</script>

</body>
</html>
{% endblock %}
